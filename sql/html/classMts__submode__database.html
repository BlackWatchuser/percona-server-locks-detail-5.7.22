<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Mts_submode_database Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classMts__submode__database-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Mts_submode_database Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="rpl__mts__submode_8h_source.html">rpl_mts_submode.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Mts_submode_database:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classMts__submode__database.png" usemap="#Mts_5Fsubmode_5Fdatabase_map" alt=""/>
  <map id="Mts_5Fsubmode_5Fdatabase_map" name="Mts_5Fsubmode_5Fdatabase_map">
<area href="classMts__submode.html" alt="Mts_submode" shape="rect" coords="0,0,147,24"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:afcfa7b9bb57cc0fc5851c5882aec84ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMts__submode__database.html#afcfa7b9bb57cc0fc5851c5882aec84ba">schedule_next_event</a> (<a class="el" href="classRelay__log__info.html">Relay_log_info</a> *rli, <a class="el" href="classLog__event.html">Log_event</a> *ev)</td></tr>
<tr class="separator:afcfa7b9bb57cc0fc5851c5882aec84ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcd2265dce959fd590c45960237b3eea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMts__submode__database.html#abcd2265dce959fd590c45960237b3eea">attach_temp_tables</a> (THD *thd, const <a class="el" href="classRelay__log__info.html">Relay_log_info</a> *rli, <a class="el" href="classQuery__log__event.html">Query_log_event</a> *ev)</td></tr>
<tr class="separator:abcd2265dce959fd590c45960237b3eea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25224ffe29bd078e228f5d43c7d7ed0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMts__submode__database.html#a25224ffe29bd078e228f5d43c7d7ed0f">detach_temp_tables</a> (THD *thd, const <a class="el" href="classRelay__log__info.html">Relay_log_info</a> *rli, <a class="el" href="classQuery__log__event.html">Query_log_event</a> *ev)</td></tr>
<tr class="separator:a25224ffe29bd078e228f5d43c7d7ed0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f0e272b7a37929ff5659fc88ed0643"><td class="memItemLeft" align="right" valign="top">Slave_worker *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMts__submode__database.html#a16f0e272b7a37929ff5659fc88ed0643">get_least_occupied_worker</a> (<a class="el" href="classRelay__log__info.html">Relay_log_info</a> *rli, Slave_worker_array *ws, <a class="el" href="classLog__event.html">Log_event</a> *ev)</td></tr>
<tr class="separator:a16f0e272b7a37929ff5659fc88ed0643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342d0daf687f50f362ddc86f767da9d0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMts__submode__database.html#a342d0daf687f50f362ddc86f767da9d0">wait_for_workers_to_finish</a> (<a class="el" href="classRelay__log__info.html">Relay_log_info</a> *rli, Slave_worker *ignore=NULL)</td></tr>
<tr class="separator:a342d0daf687f50f362ddc86f767da9d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classMts__submode"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classMts__submode')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classMts__submode.html">Mts_submode</a></td></tr>
<tr class="memitem:a8669d5047ddf9668c5d6d5d6977cb371 inherit pub_methods_classMts__submode"><td class="memItemLeft" align="right" valign="top"><a id="a8669d5047ddf9668c5d6d5d6977cb371"></a>
enum_mts_parallel_type&#160;</td><td class="memItemRight" valign="bottom"><b>get_type</b> ()</td></tr>
<tr class="separator:a8669d5047ddf9668c5d6d5d6977cb371 inherit pub_methods_classMts__submode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classMts__submode"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classMts__submode')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classMts__submode.html">Mts_submode</a></td></tr>
<tr class="memitem:a463807bdef1fea15c6bd7653b1e420ce inherit pro_attribs_classMts__submode"><td class="memItemLeft" align="right" valign="top"><a id="a463807bdef1fea15c6bd7653b1e420ce"></a>
enum_mts_parallel_type&#160;</td><td class="memItemRight" valign="bottom"><b>type</b></td></tr>
<tr class="separator:a463807bdef1fea15c6bd7653b1e420ce inherit pro_attribs_classMts__submode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">DB partitioned submode For significance of each method check definition of <a class="el" href="classMts__submode.html">Mts_submode</a> </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="abcd2265dce959fd590c45960237b3eea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcd2265dce959fd590c45960237b3eea">&#9670;&nbsp;</a></span>attach_temp_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mts_submode_database::attach_temp_tables </td>
          <td>(</td>
          <td class="paramtype">THD *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td>
          <td class="paramname"><em>rli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuery__log__event.html">Query_log_event</a> *&#160;</td>
          <td class="paramname"><em>ev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Logic to attach temporary tables. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"></td><td>THD thd <a class="el" href="classRelay__log__info.html">Relay_log_info</a> rli <a class="el" href="classQuery__log__event.html">Query_log_event</a> ev </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: void </dd></dl>

<p>Implements <a class="el" href="classMts__submode.html">Mts_submode</a>.</p>

</div>
</div>
<a id="a25224ffe29bd078e228f5d43c7d7ed0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25224ffe29bd078e228f5d43c7d7ed0f">&#9670;&nbsp;</a></span>detach_temp_tables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Mts_submode_database::detach_temp_tables </td>
          <td>(</td>
          <td class="paramtype">THD *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td>
          <td class="paramname"><em>rli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classQuery__log__event.html">Query_log_event</a> *&#160;</td>
          <td class="paramname"><em>ev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Logic to detach the temporary tables from the worker threads upon event execution </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"></td><td>thd THD instance rli <a class="el" href="classRelay__log__info.html">Relay_log_info</a> instance ev <a class="el" href="classQuery__log__event.html">Query_log_event</a> that is being applied </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: void </dd></dl>

<p>Implements <a class="el" href="classMts__submode.html">Mts_submode</a>.</p>

</div>
</div>
<a id="a16f0e272b7a37929ff5659fc88ed0643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f0e272b7a37929ff5659fc88ed0643">&#9670;&nbsp;</a></span>get_least_occupied_worker()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Slave_worker * Mts_submode_database::get_least_occupied_worker </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td>
          <td class="paramname"><em>rli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Slave_worker_array *&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLog__event.html">Log_event</a> *&#160;</td>
          <td class="paramname"><em>ev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Logic to get least occupied worker when the sql mts_submode= database </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rli</td><td>relay log info of coordinator ws arrayy of worker threads ev event for which we are searching for a worker. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>slave worker thread </dd></dl>

<p>Implements <a class="el" href="classMts__submode.html">Mts_submode</a>.</p>

</div>
</div>
<a id="afcfa7b9bb57cc0fc5851c5882aec84ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcfa7b9bb57cc0fc5851c5882aec84ba">&#9670;&nbsp;</a></span>schedule_next_event()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Mts_submode_database::schedule_next_event </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td>
          <td class="paramname"><em>rli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLog__event.html">Log_event</a> *&#160;</td>
          <td class="paramname"><em>ev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Does necessary arrangement before scheduling next event. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname"></td><td><a class="el" href="classRelay__log__info.html">Relay_log_info</a> rli </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>: 1 if error 0 no error </dd></dl>

<p>Implements <a class="el" href="classMts__submode.html">Mts_submode</a>.</p>

</div>
</div>
<a id="a342d0daf687f50f362ddc86f767da9d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342d0daf687f50f362ddc86f767da9d0">&#9670;&nbsp;</a></span>wait_for_workers_to_finish()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int Mts_submode_database::wait_for_workers_to_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRelay__log__info.html">Relay_log_info</a> *&#160;</td>
          <td class="paramname"><em>rli</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Slave_worker *&#160;</td>
          <td class="paramname"><em>ignore</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Function is called by Coordinator when it identified an event requiring sequential execution. Creating sequential context for the event includes waiting for the assigned to Workers tasks to be completed and their resources such as temporary tables be returned to Coordinator's repository. In case all workers are waited Coordinator changes its group status.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rli</td><td><a class="el" href="classRelay__log__info.html">Relay_log_info</a> instance of Coordinator </td></tr>
    <tr><td class="paramname">ignore</td><td>Optional Worker instance pointer if the sequential context is established due for the ignore Worker. Its resources are to be retained.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Resources that are not occupied by Workers such as a list of temporary tables held in unused (zero-usage) records of APH are relocated to the Coordinator placeholder.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>non-negative number of released by Workers partitions (one partition by one Worker can count multiple times)</dd></dl>
<p>or -1 to indicate there has been a failure on a not-ignored Worker as indicated by its running_status so synchronization can't succeed. </p>

<p>Implements <a class="el" href="classMts__submode.html">Mts_submode</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="rpl__mts__submode_8h_source.html">rpl_mts_submode.h</a></li>
<li>rpl_mts_submode.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
