<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: System_table_access Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classSystem__table__access-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">System_table_access Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="rpl__table__access_8h_source.html">rpl_table_access.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for System_table_access:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classSystem__table__access.png" usemap="#System_5Ftable_5Faccess_map" alt=""/>
  <map id="System_5Ftable_5Faccess_map" name="System_5Ftable_5Faccess_map">
<area href="classGtid__table__access__context.html" alt="Gtid_table_access_context" shape="rect" coords="0,56,162,80"/>
<area href="classRpl__info__table__access.html" alt="Rpl_info_table_access" shape="rect" coords="172,56,334,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8bf7d377c3f2a5e96af95fef28f689c7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSystem__table__access.html#a8bf7d377c3f2a5e96af95fef28f689c7">open_table</a> (THD *thd, const LEX_STRING dbstr, const LEX_STRING tbstr, uint max_num_field, enum thr_lock_type lock_type, <a class="el" href="structTABLE.html">TABLE</a> **table, Open_tables_backup *backup)</td></tr>
<tr class="separator:a8bf7d377c3f2a5e96af95fef28f689c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7357c29323649f270cf35b08cd8fe826"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSystem__table__access.html#a7357c29323649f270cf35b08cd8fe826">before_open</a> (THD *thd)=0</td></tr>
<tr class="separator:a7357c29323649f270cf35b08cd8fe826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0fc8878c168fcac8a7671c3e536fdc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSystem__table__access.html#a4c0fc8878c168fcac8a7671c3e536fdc">close_table</a> (THD *thd, <a class="el" href="structTABLE.html">TABLE</a> *table, Open_tables_backup *backup, bool error, bool need_commit)</td></tr>
<tr class="separator:a4c0fc8878c168fcac8a7671c3e536fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acefc48e24e7e4f522bafae15493d3a30"><td class="memItemLeft" align="right" valign="top">THD *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSystem__table__access.html#acefc48e24e7e4f522bafae15493d3a30">create_thd</a> ()</td></tr>
<tr class="separator:acefc48e24e7e4f522bafae15493d3a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a392fdc79727da6841d45a6c1f415ae53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSystem__table__access.html#a392fdc79727da6841d45a6c1f415ae53">drop_thd</a> (THD *thd)</td></tr>
<tr class="separator:a392fdc79727da6841d45a6c1f415ae53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ad974ef5ecf6cfdd230afef9d02414070"><td class="memItemLeft" align="right" valign="top"><a id="ad974ef5ecf6cfdd230afef9d02414070"></a>
uint&#160;</td><td class="memItemRight" valign="bottom"><b>m_flags</b></td></tr>
<tr class="separator:ad974ef5ecf6cfdd230afef9d02414070"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">A base class for accessing a system table. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a7357c29323649f270cf35b08cd8fe826"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7357c29323649f270cf35b08cd8fe826">&#9670;&nbsp;</a></span>before_open()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void System_table_access::before_open </td>
          <td>(</td>
          <td class="paramtype">THD *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Prepares before opening table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">thd</td><td>Thread requesting to open the table </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classGtid__table__access__context.html#a2073456f19b6b9aa81cb7d874c4f2358">Gtid_table_access_context</a>, and <a class="el" href="classRpl__info__table__access.html#a6d1ae1c8dce3fd9e3f8906acef95e9e3">Rpl_info_table_access</a>.</p>

</div>
</div>
<a id="a4c0fc8878c168fcac8a7671c3e536fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c0fc8878c168fcac8a7671c3e536fdc">&#9670;&nbsp;</a></span>close_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool System_table_access::close_table </td>
          <td>(</td>
          <td class="paramtype">THD *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Open_tables_backup *&#160;</td>
          <td class="paramname"><em>backup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>need_commit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Commits the changes, unlocks the table and closes it. This method needs to be called even if the open_table fails, in order to ensure the lock info is properly restored.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">thd</td><td>Thread requesting to close the table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">table</td><td>Table to be closed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">backup</td><td>Restore the lock info from here </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error</td><td>If there was an error while updating the table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">need_commit</td><td>Need to commit current transaction if it is true.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">true</td><td>failed </td></tr>
    <tr><td class="paramname">false</td><td>success If there is an error, rolls back the current statement. Otherwise, commits it. However, if a new thread was created and there is an error, the transaction must be rolled back. Otherwise, it must be committed. In this case, the changes were not done on behalf of any user transaction and if not finished, there would be pending changes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acefc48e24e7e4f522bafae15493d3a30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acefc48e24e7e4f522bafae15493d3a30">&#9670;&nbsp;</a></span>create_thd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">THD * System_table_access::create_thd </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Creates a new thread in the bootstrap process or in the mysqld startup, a thread is created in order to be able to access a table.</p>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">THD*</td><td>Pointer to thread structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a392fdc79727da6841d45a6c1f415ae53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a392fdc79727da6841d45a6c1f415ae53">&#9670;&nbsp;</a></span>drop_thd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void System_table_access::drop_thd </td>
          <td>(</td>
          <td class="paramtype">THD *&#160;</td>
          <td class="paramname"><em>thd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Destroys the created thread and restores the system_thread information.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">thd</td><td>Thread requesting to be destroyed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8bf7d377c3f2a5e96af95fef28f689c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bf7d377c3f2a5e96af95fef28f689c7">&#9670;&nbsp;</a></span>open_table()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool System_table_access::open_table </td>
          <td>(</td>
          <td class="paramtype">THD *&#160;</td>
          <td class="paramname"><em>thd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const LEX_STRING&#160;</td>
          <td class="paramname"><em>dbstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const LEX_STRING&#160;</td>
          <td class="paramname"><em>tbstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>max_num_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum thr_lock_type&#160;</td>
          <td class="paramname"><em>lock_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTABLE.html">TABLE</a> **&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Open_tables_backup *&#160;</td>
          <td class="paramname"><em>backup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Opens and locks a system table.</p>
<p class="">It's assumed that the caller knows what they are doing:</p><ul>
<li>whether it was necessary to reset-and-backup the open tables state</li>
<li>whether the requested lock does not lead to a deadlock</li>
<li>whether this open mode would work under LOCK TABLES, or inside a stored function or trigger.</li>
</ul>
<p class="">Note that if the table can't be locked successfully this operation will close it. Therefore it provides guarantee that it either opens and locks table or fails without leaving any tables open.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">thd</td><td>Thread requesting to open the table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dbstr</td><td>Database where the table resides </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tbstr</td><td>Table to be openned </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_num_field</td><td>Maximum number of fields </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lock_type</td><td>How to lock the table </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">table</td><td>We will store the open table here </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">backup</td><td>Save the lock info. here</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>open and lock failed - an error message is pushed into the stack </td></tr>
    <tr><td class="paramname">FALSE</td><td>success </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="rpl__table__access_8h_source.html">rpl_table_access.h</a></li>
<li>rpl_table_access.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
