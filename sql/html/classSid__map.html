<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Sid_map Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classSid__map-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Sid_map Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adcb420a3241258cc68ab42910133144d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#adcb420a3241258cc68ab42910133144d">Sid_map</a> (<a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *sid_lock)</td></tr>
<tr class="separator:adcb420a3241258cc68ab42910133144d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ebe48caba52d2bccd668088c25a8e8"><td class="memItemLeft" align="right" valign="top"><a id="a02ebe48caba52d2bccd668088c25a8e8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a02ebe48caba52d2bccd668088c25a8e8">~Sid_map</a> ()</td></tr>
<tr class="memdesc:a02ebe48caba52d2bccd668088c25a8e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy this <a class="el" href="classSid__map.html">Sid_map</a>. <br /></td></tr>
<tr class="separator:a02ebe48caba52d2bccd668088c25a8e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23aa9c0f385a44772e9e5c3955cca0cf"><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a23aa9c0f385a44772e9e5c3955cca0cf">add_sid</a> (const rpl_sid &amp;sid)</td></tr>
<tr class="separator:a23aa9c0f385a44772e9e5c3955cca0cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1667fd040c720d4ab8c35871f63926f4"><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a1667fd040c720d4ab8c35871f63926f4">sid_to_sidno</a> (const rpl_sid &amp;sid) const</td></tr>
<tr class="separator:a1667fd040c720d4ab8c35871f63926f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9a138fb42883743ec9548a6e65a56f8"><td class="memItemLeft" align="right" valign="top">const rpl_sid &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#ae9a138fb42883743ec9548a6e65a56f8">sidno_to_sid</a> (rpl_sidno sidno, bool need_lock=false) const</td></tr>
<tr class="separator:ae9a138fb42883743ec9548a6e65a56f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a136025a5e9fb2ea21eb4da9d44060fce"><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a136025a5e9fb2ea21eb4da9d44060fce">get_sorted_sidno</a> (rpl_sidno n) const</td></tr>
<tr class="separator:a136025a5e9fb2ea21eb4da9d44060fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1dbe6bf6fbaf1d6c3199cd407a620c"><td class="memItemLeft" align="right" valign="top">rpl_sidno&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#a4e1dbe6bf6fbaf1d6c3199cd407a620c">get_max_sidno</a> () const</td></tr>
<tr class="separator:a4e1dbe6bf6fbaf1d6c3199cd407a620c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a930508aff1669dabea328064ada55"><td class="memItemLeft" align="right" valign="top"><a id="ae8a930508aff1669dabea328064ada55"></a>
<a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#ae8a930508aff1669dabea328064ada55">get_sid_lock</a> () const</td></tr>
<tr class="memdesc:ae8a930508aff1669dabea328064ada55"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the sid_lock. <br /></td></tr>
<tr class="separator:ae8a930508aff1669dabea328064ada55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa02acc6896576b6a7f54fb55c1e359cd"><td class="memItemLeft" align="right" valign="top">enum_return_status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSid__map.html#aa02acc6896576b6a7f54fb55c1e359cd">copy</a> (<a class="el" href="classSid__map.html">Sid_map</a> *dest)</td></tr>
<tr class="separator:aa02acc6896576b6a7f54fb55c1e359cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p class="">Represents a bidirectional map between SID and SIDNO.</p>
<p class="">SIDNOs are always numbers greater or equal to 1.</p>
<p class="">This data structure OPTIONALLY knows of a read-write lock that protects the number of SIDNOs. The lock is provided by the invoker of the constructor and it is generally the caller's responsibility to acquire the read lock. If the lock is not NULL, access methods assert that the caller already holds the read (or write) lock. If the lock is not NULL and a method of this class grows the number of SIDNOs, then the method temporarily upgrades this lock to a write lock and then degrades it to a read lock again; there will be a short period when the lock is not held at all. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adcb420a3241258cc68ab42910133144d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcb420a3241258cc68ab42910133144d">&#9670;&nbsp;</a></span>Sid_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Sid_map::Sid_map </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheckable__rwlock.html">Checkable_rwlock</a> *&#160;</td>
          <td class="paramname"><em>sid_lock</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Create this <a class="el" href="classSid__map.html">Sid_map</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sid_lock</td><td>Read-write lock that protects updates to the number of SIDNOs. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a23aa9c0f385a44772e9e5c3955cca0cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23aa9c0f385a44772e9e5c3955cca0cf">&#9670;&nbsp;</a></span>add_sid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno Sid_map::add_sid </td>
          <td>(</td>
          <td class="paramtype">const rpl_sid &amp;&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Add the given SID to this map if it does not already exist.</p>
<p class="">The caller must hold the read lock or write lock on sid_lock before invoking this function. If the SID does not exist in this map, it will release the read lock, take a write lock, update the map, release the write lock, and take the read lock again.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sid</td><td>The SID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">SIDNO</td><td>The SIDNO for the SID (a new SIDNO if the SID did not exist, an existing if it did exist). </td></tr>
    <tr><td class="paramname">negative</td><td>Error. This function calls my_error. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa02acc6896576b6a7f54fb55c1e359cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa02acc6896576b6a7f54fb55c1e359cd">&#9670;&nbsp;</a></span>copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum_return_status Sid_map::copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSid__map.html">Sid_map</a> *&#160;</td>
          <td class="paramname"><em>dest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Deep copy this <a class="el" href="classSid__map.html">Sid_map</a> to dest.</p>
<p class="">The caller must hold: the read lock on this sid_lock the write lock on the dest sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">dest</td><td>The <a class="el" href="classSid__map.html">Sid_map</a> to which the sids and sidnos will be copied. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RETURN_STATUS_OK or RETURN_STATUS_REPORTED_ERROR. </dd></dl>

</div>
</div>
<a id="a4e1dbe6bf6fbaf1d6c3199cd407a620c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1dbe6bf6fbaf1d6c3199cd407a620c">&#9670;&nbsp;</a></span>get_max_sidno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno Sid_map::get_max_sidno </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Return the biggest sidno in this <a class="el" href="classSid__map.html">Sid_map</a>.</p>
<p class="">The caller must hold the read or write lock on sid_lock before invoking this function. </p>

</div>
</div>
<a id="a136025a5e9fb2ea21eb4da9d44060fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a136025a5e9fb2ea21eb4da9d44060fce">&#9670;&nbsp;</a></span>get_sorted_sidno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno Sid_map::get_sorted_sidno </td>
          <td>(</td>
          <td class="paramtype">rpl_sidno&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Return the n'th smallest sidno, in the order of the SID's UUID.</p>
<p class="">The caller must hold the read or write lock on sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>A number in the interval [0, <a class="el" href="classSid__map.html#a4e1dbe6bf6fbaf1d6c3199cd407a620c">get_max_sidno()</a>-1], inclusively. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1667fd040c720d4ab8c35871f63926f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1667fd040c720d4ab8c35871f63926f4">&#9670;&nbsp;</a></span>sid_to_sidno()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rpl_sidno Sid_map::sid_to_sidno </td>
          <td>(</td>
          <td class="paramtype">const rpl_sid &amp;&#160;</td>
          <td class="paramname"><em>sid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Get the SIDNO for a given SID</p>
<p class="">The caller must hold the read lock on sid_lock before invoking this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sid</td><td>The SID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">SIDNO</td><td>if the given SID exists in this map. </td></tr>
    <tr><td class="paramname">0</td><td>if the given SID does not exist in this map. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae9a138fb42883743ec9548a6e65a56f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9a138fb42883743ec9548a6e65a56f8">&#9670;&nbsp;</a></span>sidno_to_sid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const rpl_sid&amp; Sid_map::sidno_to_sid </td>
          <td>(</td>
          <td class="paramtype">rpl_sidno&#160;</td>
          <td class="paramname"><em>sidno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>need_lock</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p class="">Get the SID for a given SIDNO.</p>
<p class="">Raises an assertion if the SIDNO is not valid.</p>
<p class="">If need_lock is true, acquires sid_lock-&gt;rdlock; otherwise asserts that it is held already.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sidno</td><td>The SIDNO. </td></tr>
    <tr><td class="paramname">need_lock</td><td>If true, and sid_lock!=NULL, this function will acquire sid_lock before looking up the sid, and then release it. If false, and sid_lock!=NULL, this function will assert the sid_lock is already held. If sid_lock==NULL, nothing is done w.r.t. locking. </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">NULL</td><td>The SIDNO does not exist in this map. </td></tr>
    <tr><td class="paramname">pointer</td><td>Pointer to the SID. The data is shared with this <a class="el" href="classSid__map.html">Sid_map</a>, so should not be modified. It is safe to read the data even after this <a class="el" href="classSid__map.html">Sid_map</a> is modified, but not if this <a class="el" href="classSid__map.html">Sid_map</a> is destroyed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="rpl__gtid_8h_source.html">rpl_gtid.h</a></li>
<li>rpl_gtid_sid_map.cc</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
